cmake_minimum_required(VERSION 3.14 FATAL_ERROR)

create_tmiv_library(
    TARGET
    RendererLib
    SOURCES
    "src/Renderer.cpp"
    "src/Inpainter.cpp"
    "src/SubBlockCuller.cpp"
    "src/AdditiveSynthesizer.cpp"
    "src/ViewingSpaceController.cpp"
    "src/Rasterizer.cpp"
    "src/reprojectPoints.cpp"
    "src/ViewWeightingSynthesizer.cpp"
    "src/MpiSynthesizer.cpp"
    "src/PushPullInpainter.cpp"
    "src/RecoverPrunedViews.cpp"
    PUBLIC
    MivBitstreamLib
    PRIVATE
    ViewingSpaceLib
    Threads::Threads
    fmt::fmt)

create_tmiv_library(
    TARGET
    RendererFrontLib
    SOURCES
    "src/Front/mapInputToOutputFrames.cpp"
    "src/Front/MultipleFrameRenderer.cpp"
    PUBLIC
    IOLib
    PRIVATE
    RendererLib)

create_tmiv_executable(
    TARGET
    Renderer
    SOURCES
    "app/Renderer_main.cpp"
    "app/registerComponents.cpp"
    PRIVATE
    RendererFrontLib
    DepthQualityAssessorLib
    ViewingSpaceLib)

create_catch2_unit_test(
    TARGET
    RendererTest
    SOURCES
    "test/AccumulatingPixel_test.cpp"
    "test/AffineTransform_test.cpp"
    "test/Engine_equirectangular_test.cpp"
    "test/Engine_perspective_test.cpp"
    "test/Engine_orthographic_test.cpp"
    "test/MpiRasterizer_test.cpp"
    "test/Rasterizer_test.cpp"
    "test/PushPull_test.cpp"
    "test/PushPullInpainter_test.cpp"
    "test/RecoverPrunedViews_test.cpp"
    "test/ViewWeightingSynthesizer_test.cpp"
    PRIVATE
    RendererLib)

create_catch2_unit_test(
    TARGET
    RendererFrontTest
    SOURCES
    "test/Front/mapInputToOutputFrames_test.cpp"
    "test/Front/MultipleFrameRenderer_test.cpp"
    PRIVATE
    RendererFrontLib)
